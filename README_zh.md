# CO/MP/UT/ER

[![Rust](https://img.shields.io/badge/language-Rust-orange.svg)](https://www.rust-lang.org/)
[![Windows](https://img.shields.io/badge/platform-Windows-0078D6.svg)](https://www.microsoft.com/windows/)

**CO/MP/UT/ER** 是一款 Windows 實用工具，它能為各種系統事件提供充滿科幻風格的語音回饋。其命名旨在向經典科幻作品《星際旅行》和《異形》中的標誌性電腦系統致敬。本應用程式會將您電腦的標準通知音效，轉變為清晰、可配置的語音提示，從而創造出更具沉浸感和資訊豐富度的使用者體驗。

應用程式會在背景安靜地運行，只在重要的系統狀態發生變化時進行播報。

---

## ✨ 功能特性

- **科幻風格語音警報**: 為多種系統事件提供清晰、可配置的語音提示。
- **即時系統監控**: 採用混合事件驅動架構，確保高效率和低資源佔用。
- **動態文字轉語音 (TTS)**: 所有提示音均為即時生成，無需預錄音訊檔。
- **智慧語音選擇**:
    - **使用者可配置**: 支援透過設定檔手動選擇偏好的 TTS 語音。
    - **自動語言匹配**: 自動選擇與應用程式地區語言相匹配的語音。
    - **英語備援**: 在找不到合適的本地化語音時，預設使用清晰的英語語音。
- **完整的國際化 (i18n) 支援**: 所有提示文字均儲存在外部 JSON 檔案中，可以輕鬆添加新語言。
- **系統匣整合**:
    - 在系統匣（任務欄通知區域）中安靜地運行。
    - 透過右鍵選單，可以方便地暫停/恢復播報或打開設定介面。
    - 可在設定中開啟「開機自啟動」選項。
- **睡眠感知**: 能智慧偵測系統的睡眠與喚醒，有效避免在喚醒時出現「事件風暴」（大量無用的設備連接/斷開提示）。

### 已監控的事件
- **電源管理**:
    - 連接/斷開交流電源。
    - 物理插入/移除電池（並能在插入時播報當前電量）。
- **設備連接**:
    - 插入/拔出 USB 設備。
- **系統狀態**:
    - 應用程式啟動（能自動獲取並稱呼當前 Windows 使用者名稱）。
    - 系統進入/離開睡眠狀態。
- **網路狀態**:
    - 連接/斷開網路。
    - **能夠智慧區分** Wi-Fi、蜂巢式網路 (WWAN) 和乙太網連接。
    - 在連接到 Wi-Fi 時能播報其網路名稱 (SSID)。

---

## 🚀 快速開始

### 安裝
1.  前往專案的 [Releases 頁面](https://github.com/ECeternalcat/CO-MP-UT-ER/releases)。
2.  下載最新的 `COMPUTER.zip` 檔案。
3.  將壓縮檔解壓縮到您喜歡的位置（例如 `C:\Program Files\COMPUTER`）。
4.  雙擊 `COMPUTER.exe` 即可運行本應用程式。一個圖示將會出現在您的系統匣中。

### 設定
您可以透過編輯與 `COMPUTER.exe` 位於同一目錄下的 `config.json` 檔案來自訂應用程式的行為。

**Example `config.json`:**
```json
{
  "custom_voice": "Microsoft Zira Desktop",
  "auto_start": true
}
```
- `custom_voice`: (選填) 您想要使用的 TTS 語音的全名。此設定會覆蓋自動選擇的語音。
- `auto_start`: (選填) 設為 `true` 可以在您登入 Windows 時自動啟動本應用程式。

若要查找您系統上所有可用語音的名稱，可以運行發行版中包含的 `list_voices.exe` 工具。

---

## 🛠️ 技術棧

本專案是一個現代 Rust Windows 平台開發的範例，它融合了傳統的 Win32 API 和現代的 Windows Runtime (WinRT)。

- **核心語言**: **Rust**
- **並行與非同步**: `std::thread` 多執行緒、`mpsc` 通道、`tokio` 非同步執行時。
- **Windows 整合**: `windows-rs` 函式庫 (Win32 & WinRT)。
- **主要依賴**: `tts`, `serde`。

---

## 🤝 貢獻

歡迎任何形式的貢獻！如果您對新功能、錯誤修復或程式碼改進有任何想法，請隨時在專案的 GitHub 儲存庫中提出 Issue 或提交 Pull Request。
